---
doc: "01-core-04"
title: "Communications — iRedMail + FreePBX + Zammad"
category: communications
phase: 2 (iRedMail, Zammad) / 3 (FreePBX)
servers: [lab-comm1, lab-pbx1]
date: 2026-02-27
---

# Communications

> **Category:** Communications — Layer 4  
> **Phase:** 2 (iRedMail, Zammad) · 3 (FreePBX)  
> **Servers:** `lab-comm1` (10.0.50.14) · `lab-pbx1` (10.0.50.16)  
> **Modules:** iRedMail (09) · FreePBX (10) · Zammad (11)

---

## Module 09: iRedMail

**Repo:** [it-stack-iredmail](https://github.com/it-stack-dev/it-stack-iredmail)  
**Ports:** 25 (SMTP), 587 (submission), 143 (IMAP), 993 (IMAPS), 80/443 (webmail)  
**Subdomain:** `mail.example.com` · **Replaces:** Exchange Online, Google Workspace

### Components

| Component | Purpose |
|-----------|---------|
| Postfix | MTA — inbound/outbound SMTP |
| Dovecot | IMAP/POP3 server |
| Roundcube | Web mail client |
| SpamAssassin | Spam filtering |
| ClamAV | Antivirus scanning on attachments |
| iRedAPD | Policy daemon (rate limiting, greylisting) |
| OpenLDAP | User store (optionally federated to FreeIPA) |

### DNS Requirements

```
MX    mail.example.com           → lab-comm1
A     mail.example.com           → 10.0.50.14
SPF   v=spf1 mx a ~all
DKIM  default._domainkey          → (generated by iRedMail)
DMARC _dmarc                     → v=DMARC1; p=quarantine; rua=mailto:postmaster@example.com
```

---

## Module 10: FreePBX

**Repo:** [it-stack-freepbx](https://github.com/it-stack-dev/it-stack-freepbx)  
**Server:** `lab-pbx1` (10.0.50.16, dedicated VoIP server)  
**Ports:** 5060 (SIP UDP/TCP), 5061 (SIP TLS), 10000–20000 (RTP media)  
**Replaces:** RingCentral, 8x8, Vonage

### Architecture

```
SIP Trunk (ITSP) → Asterisk → FreePBX GUI
                       ↓
              Extensions (softphones, desk phones)
                       ↓
              SuiteCRM (CTI — click-to-call, call logging)
              Zammad   (auto-create tickets from missed calls)
```

### Key Features Configured

| Feature | Detail |
|---------|--------|
| IVR | Auto-attendant with department routing |
| Ring groups | IT support, helpdesk, sales |
| Voicemail | Email delivery via iRedMail |
| Call recording | Stored locally, linked in SuiteCRM |
| FreeIPA LDAP | Extension provisioning from directory |
| SIP TLS + SRTP | Encrypted voice traffic |

---

## Module 11: Zammad

**Repo:** [it-stack-zammad](https://github.com/it-stack-dev/it-stack-zammad)  
**Port:** 3000 (via Traefik) · **Subdomain:** `desk.example.com`  
**Replaces:** Zendesk, Freshdesk

### Ticket Channels

| Channel | Trigger |
|---------|---------|
| Email | All mail to `support@example.com` |
| Phone | FreePBX missed call webhook |
| Chat | Nextcloud Talk widget |
| API | GLPI escalation via REST |

### Integrations

| Integration | Detail |
|-------------|--------|
| Keycloak OIDC | SSO login for agents and end users |
| Elasticsearch | Full-text ticket search |
| iRedMail | Email channel (IMAP + SMTP) |
| FreePBX | CTI — auto-open ticket on inbound call |
| GLPI | Escalate IT incidents, sync CIs |
| Mattermost | Agent notifications to `#help-desk` |
